컴퓨터 구조
==========
-  컴퓨터의 기능 구조에 대한 설계 => 연산을 효율적으로 하기 위해 어떤 기능이 필요한지 고민하고 설계하는 것
-  > 대표적으로 폰 노이만 구조, 하버드 구조, 수정 하버드 구조가 있음.
-  cpu 명령어에 대한 설계 => 명령어 집합구조라고 하며 cpu가 처리해야하는 명령어를 설계하는 것
-  > 대표적으로 ARM, MIPS, AVR, 인텔의 x86, x86-64 등이 있음.
-  cpu 하드웨어적 설계 => 마이크로 아키텍처라고 하며 정의된 명령어를 효율적으로 처리 가능하도록 cpu의 회로를 설계하는 것

---------------------------------------------------------------------------------------------------------------------

## 컴퓨터 기능 구조 설계
#### 폰 노이만 구조
- 연산, 제어, 저장의 3기능을 중요시하다고 본다. => 연산과 제어는 CPU, 저장은 기억장치를 사용, 장치간의 데이터 교환은 BUS라는 전자 통로 사용
  - CPU는 산술/논리 연산을 처리하는 산술논리장치(ALU), CPU를 제어하는 제어장치, CPU에 필요한 데이터를 저장하는 레지스터로 구성됨
  - 기억장치는 용도에 따라 주기억장치와 보조기억장치로 구분되며 주기억장치는 RAM, 보조기억장치로는 SSD 등이 있음.
  - 버스는 부품 사이의 신호를 전달하는 통로로 데이터가 이동하는 데이터버스, 주소를 지정하는 주소버스, 읽기/쓰기를 제어하는 제어 버스가 있음

## 명령어 집합 구조(ISA)
- CPU가 해석하는 명령어의 집합으로 여러개인 이유는 모든 컴퓨터가 동일한 수준의 연산 능력을 요구하지 않고 환경이 다양해서 그렇다
#### x86-64 아키텍처
- IA-32의 64비트 확장 아키텍처임
 - n비트 아키텍처
 - > n은 <u>cpu가 한번에 처리할 수 있는 데이터의 크기</u>로 이를 WORD라고 부름
##### x86-64 아키텍처: 레지스터
- 우선 레지스터는 CPU가 데이터를 빠르게 저장하고 꺼내서 쓸 수 있도록 이용하는 보관소이며 다양한 용도가 있음.
- x64 아키텍처에는 __범용 레지스터, 세그먼트 레지스터, 명령어 포인터 레지스터, 플래그 레지스터__ 가 존재한다.
###### 범용 레지스터
- 주용도는 있으나, 다양한 용도로 사용가능한 레지스터
- x64 아키텍처에서 범용 레지스터는 8바이트를 저장가능함.
  - 부호 없는 정수 기준으로 2^64 - 1까지의 수를 표현 가능
  1. rax = 함수의 반환값
  2. rbx = x64에서는 주된 용도가 없음
  3. rcx = 반복문의 반복 횟수, 각종 연산의 시행 횟수
  4. rdx = x64에서는 주된 용도가 없음
  5. rsi = 데이터를 옮길 때 원본을 가리키는 포인터
  6. rdi = 데이터를 옮길 때 목적지를 가리키는 포인터
  7. rsp = 사용중인 스택의 위치를 가리키는 포인터
  8. rbp = 스택의 바닥을 가리키는 포인터
###### 세그먼트 레지스터
- x64 아키텍처에는 cs,ss,ds,es,fs,gs 총 6가지 세그먼트 레지스터가 존재함. 각각의 크기는 16비트임
- 초기 아키텍처에서는 이런 레지스터들을 통해 물리 메모리를 키우려 했지만 x64에서는 사용가능한 주소 영역이 넓어 필요없어짐
  - cs,ds,ss 레지스터는 코드 영역에서 데이터, 스택 메모리 영역을 가리킬 때 사용되고 나머지는 범용적으로 사용됨
###### 명령어 포인터 레지스터
- CPU가 어느 코드를 실행할지 가리키는 것이 역할이며 x64 아키텍처의 명령어 레지스터는 <r>rip</r>이고 크기는 8바이트임
###### 플래그 레지스터
- 프로세서의 현재 상태를 저장하는 레지스터
- x64 아키텍처에는 RFLAGS라 불리는 64비트 크기의 레지스터가 존재함.
  - 깃발을 올리고 내리는 신호를 자신을 구성하는 여러 비트로 현재 상태를 표현함
  - 자주 접하게 될 플래그
    - CF = 부호 없는 수의 연산 결과가 비트의 범위를 넘을 경우 설정됨
    - ZF = 연산 결과가 0일때
    - SF = 연산 결과가 음수일떄
    - OF = 부호 있는 수의 연산 결과가 비트 범위를 넘을 경우 설정됨
  
##### 레지스터 호환
- IA-32에서 CPU의 레지스터들은 32비트 크기이며 명칭은 각각 eax,ebx,ecx,edx,esi,edi,esp,ebp이다.
  - x64 아키텍처에서도 호환가능함.
  - rax,rbx,rcx,rdx,rsi,rdi,rsp,rbp는 이들의 확장 형태임.
  - 위의 32비트 크기 레지스터들은 64비트 레지스터의 하위 32비트를 가리킨다.
    - ex. eax는 rax의 하위 32비트를 가리킴 
- IA-32는 IA-16과의 호환도 가능 ax,bx,cx,dx,si,di,sp,dp는 위 IA-32 아키텍처 레지스터의 하위 16비트를 가리킴
- ex. rax = 0x0123456789abcdef라 했을 때, eax는 0x89abcdef이고 ax는 0xcdef, ah는 0xcd, al은 0xef 이다.

![Alt text](/regi.png)